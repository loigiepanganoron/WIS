

<div class="wrapper wrapper-content animated fadeInRight">

    <div class="row">
        <div class="col-lg-3">
            <div class="ibox">
                <div class="ibox-content">
                    @(Html.Kendo().ComboBox()
            .Name("UserType")
            .DataTextField("usertype")
            .DataValueField("roleid")
            .Placeholder("User role!")
            .HtmlAttributes(new { @style = "width:100%" })
            .Filter("contains")
            .AutoBind(true)
            .MinLength(1)
           .DataSource(source => source.Read(read => read.Action("usertype", "Home")))
                    )
                </div>
            </div>
        </div>

        <div class="col-lg-3">
            <div class="ibox">
                <div class="ibox-content">
                    @(Html.Kendo().ComboBox()
            .Name("User")
            .DataTextField("emailaddress")
            .DataValueField("eid")
            .Placeholder("Search Email Address Here!")
            .HtmlAttributes(new { @style = "width: 100%" })
            .Filter("contains")
            .AutoBind(true)
            .MinLength(2)
           .DataSource(source => source.Read(read => read.Action("userList", "Home")))
                    )
                </div>
            </div>
        </div>

        <div class="col-lg-3">
            <div class="ibox">
                <div class="ibox-content">
                    @(Html.Kendo().ComboBox()
            .Name("Office")
            .DataTextField("OfficeName")
            .DataValueField("OfficeID")
            .Placeholder("Office...")
            .HtmlAttributes(new { @style = "width: 100%" })
            .Filter("contains")
            .AutoBind(true)
            .MinLength(2)            
           .DataSource(source => source.Read(read => read.Action("OfficeNew", "Responsive")))
                    )
                </div>
            </div>
        </div>


        <div class="col-lg-2">
            <div class="ibox">
                <div class="ibox-content" style="text-align:center">
                        <button class="btn btn-sm btn-primary"  onclick="Add()"><strong>Save</strong></button>
                        @*<button class="btn btn-sm btn-primary" onclick="printna()"><strong>Print</strong></button>*@
                </div>
            </div>
        </div>

    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox">
                <div class="ibox-content">
                    @(Html.Kendo().Grid<dynamic>()
            .Name("usergrid")
            .Columns(columns =>
            {
                columns.Bound("SwipEmployeeID").Title("Swipeid").Hidden();
                columns.Bound("emailaddress").Title("Email  Address").Width(200);
                columns.Bound("usertype").Title("User Type").Width(120);
                columns.Bound("eid").Title("Employee ID").Width(100);
                columns.Bound("x").Title("").ClientTemplate("<div style=\"text-align:center\"\"> <a class=\"fa fa-trash\" style=\"font-size:20px\" onclick=\"deleteuser(#:ID#)\"> </a></div>").Width(100);
                // columns.Command(command => command.Custom("DELETE").Click("deleteuser(#:ID#)")).Width(80).HtmlAttributes(new { @style = "color:white" });
            })
            .Pageable()
           .Scrollable()

            .Selectable()
            .HtmlAttributes(new { style = "height:auto;" })
            .DataSource(dataSource => dataSource
            .Ajax()

            .ServerOperation(false)
            .PageSize(20)
             .Read(read => read.Action("SavedUsers", "Home"))

            ))
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    function Add() {



        if ($("#UserType").val() == "") {
            swal({
                title: "",
                text: "Select User Role First!",
                type: "error",
                confirmButtonText: "Ok"
            });
            return (false)
        }
        if ($("#User").val() == "") {
            swal({
                title: "",
                text: "Select Email Address First!",
                type: "error",
                confirmButtonText: "Ok"
            });
            return (false)
        }
        if ($("#Office").val() == "") {
            swal({
                title: "",
                text: "Select Office",
                type: "error",
                confirmButtonText: "Ok"
            });
            return (false)
        }
        $.post("@Url.Content("~/Home/Adduser")", { roleid: $('#UserType').val(), eid: $('#User').val(), name: $('#User').data("kendoComboBox").text(), officeid: $('#Office').val() }, function (r) {


            if (r == "1") {

                swal({
                    title: '',
                    text: 'User Was Added!',
                    type: 'success'
                });
                $("#usergrid").data("kendoGrid").dataSource.read();
                $('#usergrid').data('kendoGrid').refresh();
            }
            else {
                swal({
                    title: '',
                    text: r,
                    type: 'error'
                });
            }


        });
    }


    function deleteuser(ID) {

        swal({
            text: "Are you sure you want to delete this User?",
            title: "",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: '#DD6B55',
            confirmButtonText: 'Yes, I am sure!',
            cancelButtonText: "No, cancel it!",
            closeOnConfirm: false,
            closeOnCancel: false
        },
                function (isConfirm) {
                    if (isConfirm) {

                        $.get("@Url.Content("~/Home/Deleteuser")", { id: ID, }, function (d) {
                            //alert(d)
                            if (d == "1") {

                                swal({
                                    title: '',
                                    text: 'User Was Deleted!',
                                    type: 'success'
                                });
                                $("#usergrid").data("kendoGrid").dataSource.read();

                            }
                            else {
                                swal({
                                    title: '',
                                    text: d,
                                    type: 'error'
                                });
                            }
                        });
                    }


                    else {
                        swal("", "Deleting User Was Cancelled ", "error");
                    }

                });

        $("#usergrid").data("kendoGrid").dataSource.read();
    }
    function printna() {

        window.open("@Url.Content("~/Reports/report.aspx?repID=")" + 3, "Report", "status=1", "location=1");
    }

</script>

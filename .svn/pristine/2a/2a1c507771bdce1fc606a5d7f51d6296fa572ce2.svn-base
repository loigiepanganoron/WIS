


<div style="margin-left:300px">
    @(Html.Kendo().DropDownList()
          .Name("menu")
          .OptionLabel("All")
          .BindTo(new List<string>() {
              "IN",
              "OUT",
          })
         .HtmlAttributes(new { style = "width:70px;" })
    )
</div>
<div style="width:auto;height:auto;padding:30px 5px 10px 25px">

    <table>
        <tr>
            <td class="right">Select Item:</td>
            <td>
                @(Html.Kendo().ComboBox()
                .Name("select")
                .DataTextField("itemName")
                .DataValueField("itemid")
                .Placeholder("All Item")
                .HtmlAttributes(new { @style = "width: 200px;margin-right:-20px" })
                .Filter("contains")
                .AutoBind(true)
                .MinLength(1)
                        .DataSource(source => source.Read(read => read.Action("itembyoffice", "Home", new { officeid = ViewBag.id })))
                )
            </td>
        </tr>
        <tr>
            <td class="right"> From: </td>
            <td>
                @(Html.Kendo().DatePicker()
                    .Name("from")
                    .Value(DateTime.Today)
                    .HtmlAttributes(new { @style = "width: 150px" })
                )
            </td>
        </tr>
        <tr>
            <td class="right">To: </td>
            <td>
                @(Html.Kendo().DatePicker()
                    .Name("to")
                    .Value(DateTime.Today)
                    .HtmlAttributes(new { @style = "width: 150px" })
                )
            </td>
        </tr>
    </table>

    <button class="k-button k-primary" id="get" style="margin-top: 2em; float: right;" onclick="ready()">Print</button>


</div>

<script>
    function ready()
    {
        var offid = $('#mgaopis1').data('kendoComboBox').value();
        var startDt = document.getElementById("from").value;
        var endDt = document.getElementById("to").value;
        var off = $('#officeni').html()


        if ((new Date(startDt).getTime() > new Date(endDt).getTime()))
        {
            swal("Error", "End Date Must Be Greater Than Start Date")
        }
        else
        {
            if ($("#select").val() != "")
                window.open("@Url.Content("~/Reports/newreport.aspx?repID=")" + 1 + "&in_out=" + $("#menu").val() + "&itemid=" + $("#select").val() + "&start=" + $("#from").val() + "&end=" + $("#to").val() + "&offid=" + offid + "&off=" + off, "Report", "status=1", "location=1");
            else if ($("#select").val() == "")
                window.open("@Url.Content("~/Reports/newreport.aspx?repID=")" + 1 + "&in_out=" + $("#menu").val() + "&itemid=" + 0 + "&start=" + $("#from").val() + "&end=" + $("#to").val() + "&offid=" + offid + "&off=" + off, "Report", "status=1", "location=1");
        }
    }
</script>

<script>
    $(document).ready(function () {
        var id = $('#mgaopis1').data('kendoComboBox').value();
        $('#select').data('kendoComboBox').dataSource.read({ officeid: id })
    });
</script>

<style>
    .right {
        text-align: right;
    }

    table, tr, td {
        border-collapse: collapse;
        border: none;
    }
</style>
